# Filter API

The goal of this project is to have an API that displays products with the possibility to filter results.

## Setting up the projet

* Make sure you have MongoDB installed.
* Edit the "/shared/config.js" file if needed.
* Then run the following commands:
```
 $ npm install                # Installation of packages
 $ npm run populate           # Inserting data into the database
 $ npm run start              # Starting the project
```

## Structure of the projet

To provide the possibility of extending the project easily as well as being maintained, the project has been structured as follows:

```
FocusApp
  ├── server.js                             # Main file for starting the project
  ├── controllers
  │     ├──  product.js                     # Product Controller
  │     └──  userLog.js                     # UserLog Controller 
  ├── logs             
  │     └──  combined.log                   # Contains the errors that have occurred
  ├── middleware
  │     ├──  dbConnect.js                   # Connection to the database
  │     └──  logger.js                      # Logs errors in "/logs/combined.log"
  ├── models
  │     ├──  product.js                     # Product Model
  │     └──  userLog.js                     # UserLog Model
  ├── routes
  │     └──  product.js                     # Route to "/products"
  ├── scripts
  │     ├──  populate.js                    # Script that injects Products and UserLogs data into the database
  │     ├──  stats.js                       # Script that generates statistics on API connections
  │     └──  mockupData
  │             ├──  PRODUCTS.json          # Product data
  │             └──  USER_LOGS.json         # Data on user connections      
  ├── shared
  │     └──  config.js                      # The database config and the Port used in the application
  └──  tmp                           
        └──  statistics.txt                 # Generated by the script "/scripts/stats.js"
                                            # This file contains the information on the connections per day to the API
                                            # as well as other information such as browser and type of OS used

```

## API

The API is accessible via "/products", it offers the possibility of paging and filtering on the products in order to optimize the response time as well as to make its use more flexible, if no parameter is introduced we use the default values.

The parameters used are:
* skip: Number of items to skip (default: 0)
* take: Number of items to display (default: 25)
* like: Character string used to filter by product name (by default no filter is applied)
* minPrice: The minimum product price (default: 0)
* maxPrice: The maximum price of the product (default: INFINITY)

Example of use:
```
"/products?skip=10&take=10&minPrice=250&maxPrice=500"
```
In the example above, we retrieve a list of 10 products whose price is between 250 and 500, ignoring the first 10 elements.

At each connection, the application collects user informations to calculate the frequency of connections, the data collected is: IP address, browser, type of OS, connection date

## Scripts

Two scripts have been added to the project, the first (populate.js) being to fill our database in order to start working with the application, using the two files "PRODUCTS.json" and "USER_LOGS.json", it will be used only once, and that during the initialization of the project with the following command:

```
$ npm run populate
```

The second script will be used to create a document containing the information on daily connections to the API, and this with the following command:

```
$ npm run stats
```

The document will be generated in "/tmp" under the name "statistics.txt".

Below is an example of document display:

```
[2021-05-29]
Unique users: 6		Total number of requests: 11

[2021-05-30]
Unique users: 7		Total number of requests: 10

[2021-05-31]
Unique users: 6		Total number of requests: 13

[2021-06-01]
Unique users: 4		Total number of requests: 7

[2021-06-02]
Unique users: 8		Total number of requests: 22

[2021-06-03]
Unique users: 8		Total number of requests: 19

[2021-06-04]
Unique users: 6		Total number of requests: 12

[2021-06-05]
Unique users: 7		Total number of requests: 14

[2021-06-06]
Unique users: 5		Total number of requests: 11

[2021-06-07]
Unique users: 8		Total number of requests: 19

[2021-06-08]
Unique users: 7		Total number of requests: 16

[2021-06-09]
Unique users: 7		Total number of requests: 15

[2021-06-10]
Unique users: 7		Total number of requests: 13

[2021-06-11]
Unique users: 7		Total number of requests: 15

[2021-06-12]
Unique users: 5		Total number of requests: 9

[2021-06-13]
Unique users: 6		Total number of requests: 12

[2021-06-14]
Unique users: 4		Total number of requests: 6

[2021-06-15]
Unique users: 7		Total number of requests: 14

[2021-06-16]
Unique users: 7		Total number of requests: 10


Used browsers:
[Chrome]: 726
[Opera]: 80
[Mozilla Firefox]: 194


Used OS:
[Linux]: 122
[Windows 8]: 545
[Windows 7]: 333
```
